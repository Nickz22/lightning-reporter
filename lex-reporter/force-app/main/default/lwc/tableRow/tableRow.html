<template>
    <lightning-layout class="table-row" horizontal-align="center">
        <lightning-layout-item size="1">
            <template if:false={isEditMode}>
                <lightning-icon onclick={renderRte} 
                                icon-name="standard:messaging_conversation"
                                size="xx-small"></lightning-icon>
            </template>
            <template if:true={isEditMode}>
                <div class="rte">
                    <lightning-input-rich-text value={rteContent} 
                                               onkeyup={handleRteKeyUp}
                                               disabled-categories="ALIGN_TEXT,FORMAT_FONT,FORMAT_BODY">
                        <!-- <lightning-rich-text-toolbar-button-group slot="toolbar"
                                                                  aria-label="First group">
                            <lightning-rich-text-toolbar-button
                            icon-name="utility:check"
                            icon-alternative-text="Save"
                            onclick={handleSave}>
                            </lightning-rich-text-toolbar-button>
                        </lightning-rich-text-toolbar-button-group> -->
                    </lightning-input-rich-text>
                    <div class="user-search" style={usersPosition}>
                        <template for:each={users} for:item="user">
                            <div key={user.id} 
                                 class="lookup-user" 
                                 onclick={selectLookupUser}
                                 tabindex="-1"
                                 onkeyup={handleUserKeyUp}>
                                {user.name}
                            </div>
                        </template>
                    </div>
                </div>
            </template>

        </lightning-layout-item>
        <template for:each={cells} for:item="cell">
            <lightning-layout-item size={cellSize}
                                   key={cell.apiName}
                                   flexibility="auto"
                                   alignment-bump="right"
                                   class="cell">
                <!-- make this href point to https://speed-saas-841-dev-ed.lightning.force.com/{salesforce_record_id} -->
                <!-- 1) Ensure the Record Id is accessible in the javascript file (see the `sObjectName` variable for example)
                     2) change the href in our anchor tag to reference the full url including the accessible `sObjectId` variable -->
                <template if:true={cell.isReference}>
                    <a href="https://google.com" target="_blank">{sObjectName}</a>
                </template>
                <template if:false={cell.isReference}>
                    <template if:true={cell.isUpdateable}>
                        <lightning-input data-id={cell.apiName}
                                         value={cell.value} 
                                         type={cell.type}
                                         read-only={cell.notEditing}
                                         onchange={handleValueChange}></lightning-input>
                        <lightning-icon class="edit-icon"
                                        onclick={initEdit} 
                                        icon-name="utility:edit" 
                                        data-id={cell.apiName}
                                        size="xx-small"></lightning-icon>
                    </template>
                    <template if:false={cell.isUpdateable}>
                        <lightning-input data-id={cell.apiName} 
                                         value={cell.value} 
                                         read-only
                                         type={cell.type}
                                         onchange={handleValueChange}></lightning-input>
                    </template>
                </template>
            </lightning-layout-item>
        </template>
    </lightning-layout>
</template>
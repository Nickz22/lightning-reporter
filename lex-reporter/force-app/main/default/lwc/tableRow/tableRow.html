<template>
    <div class="table-row">
        <lightning-layout class="table-row-data" vertical-align="center">
            <lightning-layout-item size="1" 
                                    class="rte-launcher">
                <lightning-layout style="position: absolute">
                    <lightning-layout-item size="6">
                        <lightning-avatar src={previewAvatar.Url}
                                        size="x-small"
                                        variant="circle"
                                        onclick={toggleRowComments}
                                        style={previewAvatar.unreadStyle}>
                        </lightning-avatar>
                    </lightning-layout-item>
                    <lightning-layout-item size="6">
                        <lightning-icon onclick={renderRte} 
                                        icon-name="standard:messaging_conversation"
                                        size="xx-small">
                        </lightning-icon>
                    </lightning-layout-item>
                </lightning-layout>
                <template if:true={isEditMode}>
                    <div class="rte">
                        <c-rich-text-editor onsave={saveNote}
                                            onrtekeyup={handleRteKeyUp}
                                            placeholder="ESC to close | CMD+ENTER to save | FN for emojis"
                                            disabled-categories="ALIGN_TEXT,FORMAT_FONT,FORMAT_BODY"></c-rich-text-editor>
                    </div>
                </template>
            </lightning-layout-item>
            <!-- componentize table cell -->
            <template for:each={cells} for:item="cell">
                <lightning-layout-item size="3"
                            class="cell"
                            alignment-bump="top"
                            key={cell.DataId}>
                    <c-table-cell cell={cell}
                                    oncellclick={initEdit}
                                    onvaluechange={handleCellValueChange}></c-table-cell>
                </lightning-layout-item>
            </template>
        </lightning-layout>
        <c-block-rows rows={notes}
                      onblockrowmouseenter={countNoteView}></c-block-rows>
    </div>
</template>